const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/slidev/shiki-DL2InlHU.js","assets/monaco/bundled-types-DTv7Tyc7.js","assets/modules/file-saver-B6SWDYl3.js","assets/modules/vue-M-kKXBwM.js","assets/monaco/bundled-types-tXjPE9Eg.css","assets/modules/shiki-DHEo_vyh.js","assets/modules/shiki-Bxv373Z5.css"])))=>i.map(i=>d[i]);
import{t as w,d as M,G as D,o as p,b as m,Y as F,z as J,a1 as H,R as z,ac as W,Q as K,E as Y,L as q,a6 as G,e as A,x as P,H as S,F as O,K as N,c as Q,i as U,g as R,ad as X,h as Z,l as ee,k as te}from"../modules/vue-M-kKXBwM.js";import{l as ne,_ as B,d as se,b as $}from"../monaco/bundled-types-DTv7Tyc7.js";import{l as L,m as re}from"../index-B6Cw0nm-.js";import{u as ie}from"./context-CdsTkcQU.js";import{loadPyodide as oe}from"https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.mjs";import{_ as ae}from"./IconButton.vue_vue_type_script_setup_true_lang-BNIE94sW.js";import"../modules/file-saver-B6SWDYl3.js";import"../modules/shiki-DHEo_vyh.js";const T={};function le(i){return i}var ce=le;let h=null,I="{}";async function ue(i={},n){const{installs:s=[],prelude:c="",loadPackagesFromImports:r=!0,suppressDeprecationWarnings:u=!0,alwaysReload:a=!1,loadOptions:d={}}=i;return(a||I!==JSON.stringify(i))&&(h=null,I=JSON.stringify(i)),h?(r&&await h.loadPackagesFromImports(n),h):(h=await oe(d),c&&(r&&await h.loadPackagesFromImports(c),await h.runPythonAsync(c)),u&&await h.runPythonAsync(`
import warnings
warnings.filterwarnings("ignore", category=DeprecationWarning) 
`),s.length&&(await h.loadPackage("micropip"),await h.runPythonAsync(["import micropip","await micropip.install("+JSON.stringify(s)+")"].join(`
`))),r&&await h.loadPackagesFromImports(n),h)}const de=ce(()=>{const{slides:i}=L();async function n(s){var e;const c=await ue((e=i.value[0].meta.slide.frontmatter)==null?void 0:e.python,s),r=w([""]),u=w([]),a=new TextDecoder("utf-8");function d(t){const l=a.decode(t);for(const o of l.split(`
`))r.value[r.value.length-1]+=o,r.value.push("");return t.length}return c.setStdout({write:d,isatty:!0}),c.setStderr({write:d,isatty:!0}),c.runPythonAsync(s).catch(t=>{console.error(t);const l=t.toString(),o=l.match(/ModuleNotFoundError: No module named '(.*)'/);if(o)u.value.push({html:[`<div class="text-red">${o[0]}</div>`,'<div class="text-blue">Tip: This may because of this package is not a <a href="https://pyodide.org/en/stable/usage/packages-in-pyodide.html">Pyodide builtin package</a>.',"<br>You may need to install it by adding the package name to the `python.installs` array in your headmatter.","</div>"].join("")});else for(const f of l.split(`
`))u.value.push({text:f,class:"text-red"})}),()=>[...r.value.map(t=>({text:t,highlightLang:"ansi"})),...u.value]}return{python:n,py:n}}),pe=[de],me=ne(async()=>{const i={javascript:E,js:E,typescript:E,ts:E},{getHighlighter:n}=await B(async()=>{const{getHighlighter:r}=await import("./shiki-DL2InlHU.js");return{getHighlighter:r}},__vite__mapDeps([0,1,2,3,4,5,6])),s=await n(),c=async(r,u,a)=>{try{const d=i[u];if(!d)throw new Error(`Runner for language "${u}" not found`);return await d(r,{options:a,highlight:s,run:async(e,t)=>await c(e,t,a)})}catch(d){return console.error(d),{error:`${d}`}}};for(const r of pe){const u=await r(i);Object.assign(i,u)}return{highlight:s,run:c}});function fe(i){const n=w([]),s=e=>n.value.push({error:String(e)}),c=(...e)=>n.value.push(e.map(u)),r=Object.assign({},console);r.info=r.log=r.debug=r.warn=r.error=c,r.clear=()=>n.value.length=0;try{const e=`return async (console, __slidev_import, __slidev_on_error) => {
      try {
        ${d(i)}
      } catch (e) {
        __slidev_on_error(e)
      }
    }`;new Function(e)()(r,t=>{const l=T[t];if(!l)throw new Error(`Module not found: ${t}.
Available modules: ${Object.keys(T).join(", ")}. Please refer to https://sli.dev/custom/config-code-runners#additional-runner-dependencies`);return l},s)}catch(e){s(e)}function u(e){return typeof e=="string"?{text:e}:{text:a(e),highlightLang:"javascript"}}function a(e){var l;let t="";if(e instanceof Error)t=`Error: ${JSON.stringify(e.message)}`;else if(e==null||typeof e=="symbol")t=String(e);else if(Array.isArray(e))t=`[${e.map(a).join(", ")}]`;else if(e instanceof Set){const o=[...e];t=`Set (${e.size}) {${o.map(a).join(", ")}}`}else if(e instanceof Map){const o=[...e.entries()];t=`Map (${e.size}) {${o.map(([f,y])=>`${a(f)} => ${a(y)}`).join(", ")}}`}else if(e instanceof RegExp)t=e.toString();else if(typeof e=="string")t=JSON.stringify(e);else if(typeof e=="object"){const o=((l=e.constructor)==null?void 0:l.name)??"",f=o&&o==="Object"?"":o;t=(f?`${f}: `:"")+JSON.stringify(e,(x,v)=>v===void 0?"__undefined__":v,2).replace(/"__undefined__"/g,"undefined"),t=String(t)}else t=String(e);return t}function d(e){return e=e.replace('import "reflect-metadata"',"").replace('require("reflect-metadata")',""),e=e.replace("export {};",""),e}return n}let C;async function E(i){C??(C=await B(()=>import("../monaco/bundled-types-DTv7Tyc7.js").then(s=>s.t),__vite__mapDeps([1,2,3,4]))),i=C.transpileModule(i,{compilerOptions:{module:C.ModuleKind.ESNext,target:C.ScriptTarget.ES2022},transformers:{after:[he]}}).outputText;const n=/import\s*\((.+)\)/g;return i=i.replace(n,(s,c)=>`__slidev_import(${c})`),fe(i)}function he(i){const{factory:n}=i,{isImportDeclaration:s,isNamedImports:c,NodeFlags:r}=C;return u=>{var d,e;const a=[...u.statements];for(let t=0;t<a.length;t++){const l=a[t];if(!s(l))continue;let o;const f=(d=l.importClause)==null?void 0:d.namedBindings,y=[];if((e=l.importClause)!=null&&e.name&&y.push(n.createBindingElement(void 0,n.createIdentifier("default"),l.importClause.name)),f)if(c(f)){for(const v of f.elements)y.push(n.createBindingElement(void 0,v.propertyName,v.name));o=n.createObjectBindingPattern(y)}else o=n.createIdentifier(f.name.text);else o=n.createObjectBindingPattern(y);const x=n.createVariableStatement(void 0,n.createVariableDeclarationList([n.createVariableDeclaration(o,void 0,void 0,n.createAwaitExpression(n.createCallExpression(n.createIdentifier("import"),void 0,[l.moduleSpecifier])))],r.Const));a[t]=x}return n.updateSourceFile(u,a)}}const ye=M({__name:"DomElement",props:{element:{}},setup(i){const n=i,s=w();return D(()=>{s.value&&s.value.appendChild(n.element)}),(c,r)=>(p(),m("div",{ref_key:"container",ref:s},null,512))}}),ge={key:0,class:"text-sm text-center opacity-50"},ve={key:1,class:"text-sm text-center opacity-50"},_e={key:2,class:"text-sm text-center opacity-50"},we=["innerHTML"],xe={key:1,class:"text-red-500"},Se={key:3,class:"output-line"},be=["innerHTML"],ke={key:2,class:"separator"},Oe={key:0,class:"absolute right-1 top-1 max-h-full flex gap-1"},Te=M({__name:"CodeRunner",props:{modelValue:{},lang:{},autorun:{type:[Boolean,String]},height:{},showOutputAt:{type:[null,Boolean,String,Number,Array]},highlightOutput:{type:Boolean},runnerOptions:{}},emits:["update:modelValue"],setup(i,{emit:n}){const s=i,c=n,{isPrintMode:r}=L(),u=F(s,"modelValue",c),{$renderContext:a,$clicksContext:d}=ie(),e=J(()=>!["slide","presenter"].includes(a.value)),t=r.value?"once":s.autorun,l=w(t),o=H(),f=w(0),y=w(),x=w(s.showOutputAt);if(s.showOutputAt){const b=re();z(()=>{const _=d.calculate(s.showOutputAt);_?(d.register(b,_),W(()=>{x.value=!_.isActive.value})):x.value=!1}),K(()=>d.unregister(b))}const v=se(200,async()=>{if(e.value)return;const{highlight:b,run:_}=await me();y.value=b;const g=setTimeout(()=>{l.value=!0},500);o.value=await _(u.value,s.lang,s.runnerOptions??{}),f.value+=1,l.value=!1,clearTimeout(g)});return t==="once"?v():t&&Y(u,v,{immediate:!0}),(b,_)=>(p(),m(O,null,[q(A("div",{class:"relative flex flex-col rounded-b border-t border-main",style:Z({height:s.height}),"data-waitfor":".slidev-runner-output"},[e.value?(p(),m("div",ge,' Code is disabled in the "'+P(S(a))+'" mode ',1)):l.value?(p(),m("div",ve," Running... ")):o.value?(p(),m("div",{key:`run-${f.value}`,class:"slidev-runner-output"},[(p(!0),m(O,null,N(S($)(X(o.value)),(g,V)=>(p(),m(O,{key:V},["html"in g?(p(),m("div",{key:0,innerHTML:g.html},null,8,we)):"error"in g?(p(),m("div",xe,P(g.error),1)):"element"in g?(p(),Q(ye,{key:2,element:g.element},null,8,["element"])):(p(),m("div",Se,[(p(!0),m(O,null,N(S($)(g),(k,j)=>(p(),m(O,{key:j},[k.highlightLang&&y.value?(p(),m("span",{key:0,class:"highlighted",innerHTML:y.value(k.text,k.highlightLang)},null,8,be)):(p(),m("span",{key:1,class:U(k.class)},P(k.text),3)),j<S($)(g).length-1?(p(),m("span",ke,",")):R("v-if",!0)],64))),128))]))],64))),128))])):(p(),m("div",_e," Click the play button to run the code "))],4),[[G,!x.value]]),S(u).trim()?(p(),m("div",Oe,[ee(ae,{class:"w-8 h-8 max-h-full flex justify-center items-center",title:"Run code",onClick:S(v)},{default:te(()=>_[0]||(_[0]=[A("div",{class:"i-carbon:play"},null,-1)])),_:1},8,["onClick"])])):R("v-if",!0)],64))}});export{Te as default};
